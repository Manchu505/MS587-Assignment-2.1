<!DOCTYPE html>
<!-- The above declaration defines this document as HTML5 -->

<html lang="en">
<!-- This <html> tag starts the document with language set to English -->

<head>
    <!-- The <head> tag contains meta-information about the document, like its title and linked resources -->
    <meta charset="UTF-8">
    <!-- This meta tag sets the character encoding of the web page to UTF-8, which includes most characters from all known languages -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- This meta tag makes the web page responsive by setting the viewport width to the width of the device and the initial zoom level to 1 -->
    <title>eBook and Audiobook Application</title>
    <!-- Sets the title of the webpage as it appears in the browser tab -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <!-- Link to an external stylesheet file for styling the webpage. The URL is dynamically generated by Flask. -->
</head>
<body>
    <!-- The <body> tag contains the content of the webpage that is visible to users -->
    <div class="container">
        <!-- A container div that helps in managing the layout of the webpage -->
        <h1>eBook and Audiobook Application</h1>
        <!-- Main heading of the webpage -->
        <div class="list-group mt-4">
            <!-- A styled div to list eBooks, with a top margin (mt-4) -->
            {% for ebook_id in ebook_ids %}
                <!-- Start of a loop that iterates over each eBook ID provided by the Flask backend -->
                <div class="list-group-item">
                    <!-- Each eBook ID is wrapped in a div that styles it as an item in the list -->
                    <h5 class="mb-1">{{ ebook_id }}</h5>
                    <!-- Display the eBook ID as a subheading, with a bottom margin -->
                    <!-- Conditionally display book cover images based on eBook ID -->
                    {% if ebook_id == 'The Shadow Agent' %}
                        <img src="{{ url_for('static', filename='image1.png') }}" alt="Sample Book Image" class="book-image mb-4">
                    {% elif ebook_id == 'Whispers in the Dark' %}
                        <img src="{{ url_for('static', filename='image2.png') }}" alt="Sample Book Image" class="book-image mb-4">
                    {% elif ebook_id == 'Starlight Chronicles - The Lost Galaxy' %}
                        <img src="{{ url_for('static', filename='image3.png') }}" alt="Sample Book Image" class="book-image mb-4">
                    {% elif ebook_id == 'Echoes of the Past' %}
                        <img src="{{ url_for('static', filename='image4.png') }}" alt="Sample Book Image" class="book-image mb-4">
                    {% elif ebook_id == 'The Quantum Heist' %}
                        <img src="{{ url_for('static', filename='image5.png') }}" alt="Sample Book Image" class="book-image mb-4">
                    {% endif %}
                    <!-- Links to download, listen, or read the eBook -->
                    <a href="{{ url_for('download_ebook', ebook_id=ebook_id) }}" class="btn">Download eBook</a>
                    <!-- Button to download the eBook -->
                    <button class="btn" onclick="playAudio('{{ url_for('audiobook', ebook_id=ebook_id) }}')">Listen to Audiobook</button>
                    <!-- Button that triggers playing the audiobook -->
                    <a href="{{ url_for('read_ebook', ebook_id=ebook_id) }}" class="btn btn-info">Read Sample</a>
                    <!-- Link to read a sample of the eBook -->
                </div>
            {% endfor %}
        </div>
    </div>
    <audio id="audioPlayer" controls></audio>
    <!-- Audio player element for playing audiobooks, with controls like play, pause, etc. -->
    <div class="center-button">
        <button class="btn btn-danger" onclick="stopAudio()">Stop Audio</button>
        <!-- Button to stop the audio, styled with 'btn-danger' to indicate a destructive action -->
    </div>
    <script>
        // JavaScript functions to control audio playback
        function playAudio(audioUrl) {
            var audioPlayer = document.getElementById('audioPlayer');
            // Retrieves the audio player by its ID
            audioPlayer.src = audioUrl;
            // Sets the source of the audio to the passed URL
            audioPlayer.play();
            // Plays the audio

            // Event listener to redirect to the homepage when the audio ends
            audioPlayer.onended = function() {
                window.location.href = '/';
            };
        }

        function stopAudio() {
            var audioPlayer = document.getElementById('audioPlayer');
            // Retrieves the audio player by its ID
            audioPlayer.pause();
            // Pauses the audio
            audioPlayer.currentTime = 0;
            // Resets the audio to the start
            window.location.href = '/';
            // Redirects to the homepage
        }
    </script>
</body>
</html>
